{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mario/PycharmProjects/futbol7/lib/mongodb.ts"],"sourcesContent":["import { MongoClient, Db } from 'mongodb';\r\n\r\nlet cachedClient: MongoClient | null = null;\r\nlet cachedDb: Db | null = null;\r\n\r\nexport async function connectToDatabase() {\r\n  if (cachedClient && cachedDb) {\r\n    return { client: cachedClient, db: cachedDb };\r\n  }\r\n\r\n  if (!process.env.MONGODB_URI) {\r\n    throw new Error('MONGODB_URI no está definida');\r\n  }\r\n\r\n  const client = new MongoClient(process.env.MONGODB_URI);\r\n\r\n  await client.connect();\r\n  const db = client.db(process.env.MONGODB_DB || 'futbol7');\r\n\r\n  cachedClient = client;\r\n  cachedDb = db;\r\n\r\n  return { client, db };\r\n}\r\n\r\nexport async function getDatabase() {\r\n  const { db } = await connectToDatabase();\r\n  return db;\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,eAAmC;AACvC,IAAI,WAAsB;AAEnB,eAAe;IACpB,IAAI,gBAAgB,UAAU;QAC5B,OAAO;YAAE,QAAQ;YAAc,IAAI;QAAS;IAC9C;IAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;QAC5B,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,SAAS,IAAI,sHAAW,CAAC,QAAQ,GAAG,CAAC,WAAW;IAEtD,MAAM,OAAO,OAAO;IACpB,MAAM,KAAK,OAAO,EAAE,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;IAE/C,eAAe;IACf,WAAW;IAEX,OAAO;QAAE;QAAQ;IAAG;AACtB;AAEO,eAAe;IACpB,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mario/PycharmProjects/futbol7/lib/models.ts"],"sourcesContent":["import { hash, compare } from 'bcryptjs';\r\nimport { ObjectId } from 'mongodb';\r\n\r\nexport interface User {\r\n  _id?: ObjectId;\r\n  email: string;\r\n  password: string;\r\n  nombre: string;\r\n  rol: 'admin' | 'equipo' | 'externo';\r\n  equipo_id?: string;\r\n  fechaCreacion: Date;\r\n  activo: boolean;\r\n}\r\n\r\nexport interface Equipo {\r\n  _id?: ObjectId;\r\n  nombre: string;\r\n  user_id: string; // Usuario tipo 'equipo' propietario\r\n  temporada: number;\r\n  descripcion?: string;\r\n  ciudad?: string;\r\n  fechaCreacion: Date;\r\n}\r\n\r\nexport interface Jugador {\r\n  _id?: ObjectId;\r\n  equipo_id: string;\r\n  nombre: string;\r\n  posicion: string;\r\n  dorsal?: number;\r\n  goles: number;\r\n  fechaCreacion: Date;\r\n}\r\n\r\nexport interface Partido {\r\n  _id?: ObjectId;\r\n  equipo_id: string;\r\n  rival: string;\r\n  fecha: Date;\r\n  estado: 'programado' | 'en_vivo' | 'finalizado';\r\n  goles_equipo: number;\r\n  goles_rival: number;\r\n  goleadores: { jugador: string; goles: number }[];\r\n  resultado?: string;\r\n  notas?: string;\r\n}\r\n\r\n// Funciones de hash\r\nexport async function hashPassword(password: string) {\r\n  return hash(password, 10);\r\n}\r\n\r\nexport async function comparePassword(password: string, hashedPassword: string) {\r\n  return compare(password, hashedPassword);\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAgDO,eAAe,aAAa,QAAgB;IACjD,OAAO,IAAA,2IAAI,EAAC,UAAU;AACxB;AAEO,eAAe,gBAAgB,QAAgB,EAAE,cAAsB;IAC5E,OAAO,IAAA,8IAAO,EAAC,UAAU;AAC3B","debugId":null}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mario/PycharmProjects/futbol7/lib/auth.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst SECRET = process.env.JWT_SECRET || 'tu_clave_secreta_super_segura';\r\n\r\nexport interface TokenPayload {\r\n  userId: string;\r\n  email: string;\r\n  rol: 'admin' | 'equipo' | 'externo';\r\n}\r\n\r\nexport function createToken(payload: TokenPayload) {\r\n  return jwt.sign(payload, SECRET, { expiresIn: '7d' });\r\n}\r\n\r\nexport function verifyToken(token: string): TokenPayload | null {\r\n  try {\r\n    return jwt.verify(token, SECRET) as TokenPayload;\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;AAQlC,SAAS,YAAY,OAAqB;IAC/C,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,QAAQ;QAAE,WAAW;IAAK;AACrD;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mario/PycharmProjects/futbol7/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { getDatabase } from '@/lib/mongodb';\r\nimport { comparePassword } from '@/lib/models';\r\nimport { createToken } from '@/lib/auth';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email, password } = await request.json();\r\n\r\n    if (!email || !password) {\r\n      return NextResponse.json(\r\n        { error: 'Email y contraseña requeridos' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const db = await getDatabase();\r\n    const user = await db.collection('usuarios').findOne({ email });\r\n\r\n    if (!user) {\r\n      return NextResponse.json(\r\n        { error: 'Usuario no encontrado' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const passwordMatch = await comparePassword(password, user.password);\r\n    if (!passwordMatch) {\r\n      return NextResponse.json(\r\n        { error: 'Contraseña incorrecta' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const token = createToken({\r\n      userId: user._id.toString(),\r\n      email: user.email,\r\n      rol: user.rol,\r\n    });\r\n\r\n    const response = NextResponse.json({\r\n      token,\r\n      user: {\r\n        id: user._id.toString(),\r\n        email: user.email,\r\n        nombre: user.nombre,\r\n        rol: user.rol,\r\n      },\r\n    });\r\n\r\n    // Guardar token en cookie también (para middleware)\r\n    response.cookies.set('token', token, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === 'production',\r\n      sameSite: 'lax',\r\n      maxAge: 60 * 60 * 24 * 7, // 7 días\r\n    });\r\n\r\n    return response;\r\n  } catch (error) {\r\n    console.error('Error en login:', error);\r\n    return NextResponse.json(\r\n      { error: 'Error interno del servidor' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAgC,GACzC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,KAAK,MAAM,IAAA,+HAAW;QAC5B,MAAM,OAAO,MAAM,GAAG,UAAU,CAAC,YAAY,OAAO,CAAC;YAAE;QAAM;QAE7D,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwB,GACjC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,gBAAgB,MAAM,IAAA,kIAAe,EAAC,UAAU,KAAK,QAAQ;QACnE,IAAI,CAAC,eAAe;YAClB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwB,GACjC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,IAAA,4HAAW,EAAC;YACxB,QAAQ,KAAK,GAAG,CAAC,QAAQ;YACzB,OAAO,KAAK,KAAK;YACjB,KAAK,KAAK,GAAG;QACf;QAEA,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YACjC;YACA,MAAM;gBACJ,IAAI,KAAK,GAAG,CAAC,QAAQ;gBACrB,OAAO,KAAK,KAAK;gBACjB,QAAQ,KAAK,MAAM;gBACnB,KAAK,KAAK,GAAG;YACf;QACF;QAEA,oDAAoD;QACpD,SAAS,OAAO,CAAC,GAAG,CAAC,SAAS,OAAO;YACnC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA6B,GACtC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}