(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{6613:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(71847).A)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},20063:(e,r,a)=>{"use strict";var t=a(47260);a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})},24033:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(71847).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},42819:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>u});var t=a(95155),s=a(12115),l=a(20063),i=a(71847);let n=(0,i.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var o=a(6613);let d=(0,i.A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),c=(0,i.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var x=a(24033),m=a(91169);let h=(0,i.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),g="7ec6e1c6-9704-496c-ae72-a590817b9568";function u(){let e=(0,l.useRouter)(),[r,a]=(0,s.useState)(null),[i,u]=(0,s.useState)([]),[p,y]=(0,s.useState)([]),[b,f]=(0,s.useState)(!0),[j,v]=(0,s.useState)(""),[N,w]=(0,s.useState)(0),[k,C]=(0,s.useState)(0),[A,S]=(0,s.useState)({}),[M,_]=(0,s.useState)(!1),[q,E]=(0,s.useState)(null),z=N-Object.values(A).reduce((e,r)=>e+r,0);(0,s.useEffect)(()=>{let r=localStorage.getItem("user");if(!r)return void e.push("/login");let t=JSON.parse(r);if("admin"!==t.rol&&"equipo"!==t.rol)return void e.push("/login");a(t),O()},[e]);let O=async()=>{try{let[e,r]=await Promise.all([fetch("/api/matches?equipo_id=".concat(g,"&t=").concat(Date.now())),fetch("/api/players?equipo_id=".concat(g,"&t=").concat(Date.now()))]);if(e.ok&&r.ok){let a=await e.json(),t=await r.json();u(a.partidos||[]),y(t.jugadores||[])}}catch(e){console.error("Error fetching admin data:",e)}finally{f(!1)}},P=(e,r)=>{S(a=>{let t=Math.max(0,(a[e]||0)+r);return Object.values({...a,[e]:t}).reduce((e,r)=>e+r,0)>N?a:{...a,[e]:t}})},H=(e,r)=>{E({message:e,type:r}),setTimeout(()=>E(null),4e3)},R=async()=>{if(!j)return void H("Selecciona un partido primero","error");if(0!==z)return void H("Faltan ".concat(z," goles por asignar a los jugadores"),"error");_(!0);let e=Object.entries(A).filter(e=>{let[r,a]=e;return a>0}).map(e=>{let[r,a]=e,t=p.find(e=>e.id===r);return{id:r,nombre:null==t?void 0:t.nombre,posicion:null==t?void 0:t.posicion,dorsal:null==t?void 0:t.dorsal,goles:a}});try{let r=await fetch("/api/admin/update-match",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:j,golesEquipo:N,golesRival:k,goleadores:e})}),a=await r.json();r.ok?(H("Partido actualizado con \xe9xito","success"),v(""),w(0),C(0),S({}),O()):H(a.error||"Error al guardar","error")}catch(e){H(e.message||"Error de conexi\xf3n","error")}finally{_(!1)}};return r?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-950 text-gray-100 font-sans selection:bg-primary/30",children:[(0,t.jsx)("nav",{className:"border-b border-gray-800 bg-gray-900/50 backdrop-blur-md sticky top-0 z-50",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-primary"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-white tracking-tight",children:["Admin",(0,t.jsx)("span",{className:"text-primary",children:"Panel"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-400 hidden sm:inline-block",children:["Hola, ",(0,t.jsx)("span",{className:"text-gray-200",children:r.nombre})]}),(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e.push("/login")},className:"text-sm bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white px-4 py-2 rounded-lg transition-all font-medium",children:"Cerrar sesi\xf3n"})]})]})}),(0,t.jsxs)("main",{className:"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 mt-6",children:[q&&(0,t.jsxs)("div",{className:"fixed top-20 right-4 flex items-center gap-2 px-4 py-3 rounded-lg shadow-xl border z-50 animate-in slide-in-from-top-4 fade-in ".concat("success"===q.type?"bg-emerald-950/80 border-emerald-500/50 text-emerald-200":"bg-red-950/80 border-red-500/50 text-red-200"),children:["success"===q.type?(0,t.jsx)(d,{className:"h-5 w-5"}):(0,t.jsx)(c,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:q.message})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-extrabold text-white tracking-tight",children:"Gesti\xf3n de Partidos"}),(0,t.jsx)("p",{className:"text-gray-400 mt-2 text-lg",children:"Actualiza el resultado y asigna los goleadores de la jornada."})]}),b?(0,t.jsxs)("div",{className:"flex items-center justify-center h-64 bg-gray-900/50 rounded-2xl border border-gray-800",children:[(0,t.jsx)(n,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("span",{className:"ml-3 text-gray-400",children:"Cargando datos de liga..."})]}):(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-5 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl p-6 shadow-sm",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-300 mb-2",children:"Seleccionar Partido"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{className:"w-full appearance-none bg-gray-950 border border-gray-700 text-white py-3 px-4 pr-10 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-colors",value:j,onChange:e=>(e=>{v(e);let r=i.find(r=>r.id===e);r&&"finalizado"===r.estado?(w(r.goles_equipo||0),C(r.goles_rival||0)):(w(0),C(0)),S({})})(e.target.value),children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Elige un partido --"}),i.map(e=>(0,t.jsxs)("option",{value:e.id,children:["finalizado"===e.estado?"✅":"⏳"," vs ",e.rival," (",new Date(e.fecha).toLocaleDateString(),")"]},e.id))]}),(0,t.jsx)(x.A,{className:"absolute right-4 top-3.5 h-5 w-5 text-gray-500 pointer-events-none"})]})]}),j&&(0,t.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl p-6 shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-primary"}),"Marcador Final"]}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-6",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-400 mb-3 text-center",children:"Nuestro Equipo"}),(0,t.jsxs)("div",{className:"flex items-center bg-gray-950 border border-gray-700 rounded-xl overflow-hidden shadow-inner",children:[(0,t.jsx)("button",{onClick:()=>{w(e=>Math.max(0,e-1)),S({})},className:"px-4 py-3 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",children:"-"}),(0,t.jsx)("input",{type:"number",min:"0",readOnly:!0,className:"w-16 bg-transparent text-center text-2xl font-bold text-white border-0 focus:ring-0 p-0",value:N}),(0,t.jsx)("button",{onClick:()=>w(e=>e+1),className:"px-4 py-3 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",children:"+"})]})]}),(0,t.jsx)("div",{className:"text-xl font-black text-gray-600 self-end mb-4",children:"VS"}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-400 mb-3 text-center",children:"Equipo Rival"}),(0,t.jsxs)("div",{className:"flex items-center bg-gray-950 border border-gray-700 rounded-xl overflow-hidden shadow-inner",children:[(0,t.jsx)("button",{onClick:()=>C(e=>Math.max(0,e-1)),className:"px-4 py-3 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",children:"-"}),(0,t.jsx)("input",{type:"number",min:"0",readOnly:!0,className:"w-16 bg-transparent text-center text-2xl font-bold text-white border-0 focus:ring-0 p-0",value:k}),(0,t.jsx)("button",{onClick:()=>C(e=>e+1),className:"px-4 py-3 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",children:"+"})]})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-7",children:j?(0,t.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl p-6 shadow-sm h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"flex justify-between items-end mb-6 border-b border-gray-800 pb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 text-primary"}),"Goleadores del Partido"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Asigna qui\xe9n marc\xf3 nuestros ",N," goles."]})]}),(0,t.jsx)("div",{className:"px-3 py-1 rounded-full text-sm font-bold ".concat(0===z?"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20":"bg-amber-500/10 text-amber-500 border border-amber-500/20"),children:0===z?"Completado":"Faltan ".concat(z)})]}),0===N?(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8 bg-gray-950/50 rounded-xl border border-dashed border-gray-800",children:[(0,t.jsx)(c,{className:"h-10 w-10 text-gray-600 mb-3"}),(0,t.jsx)("p",{className:"text-gray-400",children:"No ganamos esta vez. No hay goles que registrar a favor."})]}):(0,t.jsx)("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 pb-4 max-h-[400px]",children:p.map(e=>{let r=A[e.id]||0;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl transition-colors ".concat(r>0?"bg-primary/10 border border-primary/30":"bg-gray-950 hover:bg-gray-800 border border-gray-800"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gray-800 text-xs font-bold text-gray-300",children:e.dorsal}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-200",children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.posicion})]})]}),(0,t.jsxs)("div",{className:"flex items-center bg-gray-900 border border-gray-700 rounded-lg overflow-hidden",children:[(0,t.jsx)("button",{onClick:()=>P(e.id,-1),disabled:0===r,className:"px-3 py-1.5 hover:bg-gray-800 disabled:opacity-30 disabled:hover:bg-transparent text-gray-400 transition-colors",children:"-"}),(0,t.jsx)("span",{className:"w-8 text-center font-bold ".concat(r>0?"text-primary":"text-gray-500"),children:r}),(0,t.jsx)("button",{onClick:()=>P(e.id,1),disabled:0===z,className:"px-3 py-1.5 hover:bg-gray-800 disabled:opacity-30 disabled:hover:bg-transparent text-gray-400 transition-colors",children:"+"})]})]},e.id)})}),(0,t.jsx)("div",{className:"mt-auto pt-6 border-t border-gray-800",children:(0,t.jsx)("button",{onClick:R,disabled:M||0!==z,className:"w-full flex items-center justify-center gap-2 bg-primary hover:bg-primary/90 text-primary-foreground font-bold py-4 px-6 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-[0_0_20px_rgba(20,184,106,0.15)] hover:shadow-[0_0_25px_rgba(20,184,106,0.3)] active:scale-[0.98]",children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n,{className:"h-5 w-5 animate-spin"})," Guardando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{className:"h-5 w-5"})," Guardar Resultado del Partido"]})})})]}):(0,t.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-2xl p-6 h-full flex flex-col items-center justify-center text-center opacity-70",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mb-4 text-gray-500",children:(0,t.jsx)(o.A,{className:"h-8 w-8"})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-300 mb-2",children:"Ning\xfan partido seleccionado"}),(0,t.jsx)("p",{className:"text-gray-500 max-w-sm",children:"Selecciona un partido de la lista para modificar su marcador y sus goleadores."})]})})]})]})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,t.jsx)(n,{className:"animate-spin text-primary h-8 w-8"})})}},55477:(e,r,a)=>{Promise.resolve().then(a.bind(a,42819))},71847:(e,r,a)=>{"use strict";a.d(r,{A:()=>n});var t=a(12115);let s=function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)((e,r)=>{let{color:a="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:x,...m}=e;return(0,t.createElement)("svg",{ref:r,...l,width:i,height:i,stroke:a,strokeWidth:o?24*Number(n)/Number(i):n,className:s("lucide",d),...m},[...x.map(e=>{let[r,a]=e;return(0,t.createElement)(r,a)}),...Array.isArray(c)?c:[c]])}),n=(e,r)=>{let a=(0,t.forwardRef)((a,l)=>{let{className:n,...o}=a;return(0,t.createElement)(i,{ref:l,iconNode:r,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...o})});return a.displayName="".concat(e),a}},91169:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(71847).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},e=>{e.O(0,[441,255,358],()=>e(e.s=55477)),_N_E=e.O()}]);