(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{3941:(e,a,r)=>{"use strict";r.d(a,{N:()=>t});let t=(0,r(92373).UU)("https://aknyrfoxlpphebkfomwx.supabase.co","sb_publishable_Z36O_vV2RpFxkajpCPpU7w_D9ve-o3k")},6613:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(71847).A)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},24033:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(71847).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},42819:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>p});var t=r(95155),s=r(12115),l=r(20063),i=r(71847);let n=(0,i.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var o=r(6613);let d=(0,i.A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),c=(0,i.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var x=r(24033);let m=(0,i.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var g=r(3941);let h="7ec6e1c6-9704-496c-ae72-a590817b9568";function p(){let e=(0,l.useRouter)(),[a,r]=(0,s.useState)(null),[i,p]=(0,s.useState)([]),[u,b]=(0,s.useState)([]),[y,f]=(0,s.useState)(!0),[v,j]=(0,s.useState)(""),[N,w]=(0,s.useState)(0),[k,C]=(0,s.useState)(0),[_,D]=(0,s.useState)({}),[z,A]=(0,s.useState)(!1),[S,M]=(0,s.useState)(null),E=N-Object.values(_).reduce((e,a)=>e+a,0);(0,s.useEffect)(()=>{(async()=>{let{data:{session:a}}=await g.N.auth.getSession();if(!a)return e.push("/login");let{data:t}=await g.N.from("usuarios").select("*").eq("id",a.user.id).single();if(!t||"admin"!==t.rol&&"equipo"!==t.rol)return e.push("/login");r({...t,email:a.user.email}),q()})()},[e]);let q=async()=>{try{let[e,a]=await Promise.all([fetch("/api/matches?equipo_id=".concat(h,"&t=").concat(Date.now())),fetch("/api/players?equipo_id=".concat(h,"&t=").concat(Date.now()))]);if(e.ok&&a.ok){let r=await e.json(),t=await a.json();p(r.partidos||[]),b(t.jugadores||[])}}catch(e){console.error("Error fetching admin data:",e)}finally{f(!1)}},O=async()=>{await g.N.auth.signOut(),e.push("/login")},P=(e,a)=>{D(r=>{let t=Math.max(0,(r[e]||0)+a);return Object.values({...r,[e]:t}).reduce((e,a)=>e+a,0)>N?r:{...r,[e]:t}})},F=(e,a)=>{M({message:e,type:a}),setTimeout(()=>M(null),4e3)},H=async()=>{if(!v)return void F("Selecciona un partido primero","error");if(0!==E)return void F("Faltan ".concat(E," goles por asignar a los jugadores"),"error");A(!0);let e=Object.entries(_).filter(e=>{let[a,r]=e;return r>0}).map(e=>{let[a,r]=e,t=u.find(e=>e.id===a);return{id:a,nombre:null==t?void 0:t.nombre,posicion:null==t?void 0:t.posicion,dorsal:null==t?void 0:t.dorsal,goles:r}});try{let a=await fetch("/api/admin/update-match",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:v,golesEquipo:N,golesRival:k,goleadores:e})}),r=await a.json();a.ok?(F("Partido actualizado con \xe9xito","success"),j(""),w(0),C(0),D({}),q()):F(r.error||"Error al guardar","error")}catch(e){F(e.message||"Error de conexi\xf3n","error")}finally{A(!1)}};return a?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-950 text-gray-100 font-sans selection:bg-primary/30",children:[(0,t.jsx)("nav",{className:"border-b border-gray-800 bg-gray-900/50 backdrop-blur-md sticky top-0 z-50",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-primary"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-white tracking-tight",children:["Admin",(0,t.jsx)("span",{className:"text-primary",children:"Panel"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-400 hidden sm:inline-block",children:["Hola, ",(0,t.jsx)("span",{className:"text-gray-200",children:a.nombre})]}),(0,t.jsx)("button",{onClick:O,className:"text-sm bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white px-4 py-2 rounded-lg transition-all font-medium",children:"Cerrar sesi\xf3n"})]})]})}),(0,t.jsxs)("main",{className:"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 mt-6",children:[S&&(0,t.jsxs)("div",{className:"fixed top-20 right-4 flex items-center gap-2 px-4 py-3 rounded-lg shadow-xl border z-50 animate-in slide-in-from-top-4 fade-in ".concat("success"===S.type?"bg-emerald-950/80 border-emerald-500/50 text-emerald-200":"bg-red-950/80 border-red-500/50 text-red-200"),children:["success"===S.type?(0,t.jsx)(d,{className:"h-5 w-5"}):(0,t.jsx)(c,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:S.message})]}),(0,t.jsxs)("div",{className:"mb-8 bg-gradient-to-r from-gray-900 to-gray-900/50 p-8 rounded-3xl border border-gray-800/60 shadow-lg relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),(0,t.jsx)("h1",{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-400 tracking-tight relative z-10 flex items-center gap-3",children:"\uD83D\uDC51 Panel de Administraci\xf3n"}),(0,t.jsx)("p",{className:"text-gray-400 mt-3 text-lg relative z-10 max-w-xl",children:"Control de mandos de Impersed Cubiertas FC. Actualiza resultados y asigna goleadores."})]}),y?(0,t.jsxs)("div",{className:"flex items-center justify-center h-64 bg-gray-900/50 rounded-2xl border border-gray-800",children:[(0,t.jsx)(n,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("span",{className:"ml-3 text-gray-400",children:"Cargando datos de liga..."})]}):(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-5 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-gray-800/80 rounded-3xl p-6 shadow-xl relative overflow-hidden group",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-300 mb-3 flex items-center gap-2 relative z-10",children:"\uD83D\uDCC5 Seleccionar Partido"}),(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsxs)("select",{className:"w-full appearance-none bg-gray-950/80 border border-gray-700 text-white py-4 px-5 pr-12 rounded-2xl focus:outline-none focus:ring-2 focus:ring-primary/60 focus:border-primary transition-all shadow-inner text-base font-medium",value:v,onChange:e=>(e=>{j(e);let a=i.find(a=>a.id===e);a&&"finalizado"===a.estado?(w(a.goles_equipo||0),C(a.goles_rival||0)):(w(0),C(0)),D({})})(e.target.value),children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"-- Elige un partido a gestionar --"}),i.map(e=>(0,t.jsxs)("option",{value:e.id,children:["finalizado"===e.estado?"\uD83C\uDFC1":"⏳"," vs ",e.rival," (",new Date(e.fecha).toLocaleDateString(),")"]},e.id))]}),(0,t.jsx)(x.A,{className:"absolute right-5 top-4 h-6 w-6 text-gray-500 pointer-events-none"})]})]}),v&&(0,t.jsxs)("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-gray-800/80 rounded-3xl p-6 shadow-xl relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tr from-accent/5 to-transparent pointer-events-none"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-8 flex items-center gap-3 relative z-10",children:"\uD83C\uDFAF Marcador Final"}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-6 relative z-10",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-primary mb-3 text-center uppercase tracking-wider",children:"\uD83D\uDEE1️ Nosotros"}),(0,t.jsxs)("div",{className:"flex items-center bg-gray-950 border border-primary/30 rounded-2xl overflow-hidden shadow-[0_0_15px_rgba(20,184,106,0.1)]",children:[(0,t.jsx)("button",{onClick:()=>{w(e=>Math.max(0,e-1)),D({})},className:"px-5 py-4 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors active:bg-gray-700",children:"-"}),(0,t.jsx)("input",{type:"number",min:"0",readOnly:!0,className:"w-16 bg-transparent text-center text-3xl font-black text-white border-0 focus:ring-0 p-0",value:N}),(0,t.jsx)("button",{onClick:()=>w(e=>e+1),className:"px-5 py-4 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors active:bg-gray-700",children:"+"})]})]}),(0,t.jsx)("div",{className:"text-2xl font-black text-gray-600 self-end mb-5",children:"VS"}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-red-400 mb-3 text-center uppercase tracking-wider",children:"\uD83D\uDD25 Rival"}),(0,t.jsxs)("div",{className:"flex items-center bg-gray-950 border border-red-500/30 rounded-2xl overflow-hidden shadow-[0_0_15px_rgba(239,68,68,0.1)]",children:[(0,t.jsx)("button",{onClick:()=>C(e=>Math.max(0,e-1)),className:"px-5 py-4 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors active:bg-gray-700",children:"-"}),(0,t.jsx)("input",{type:"number",min:"0",readOnly:!0,className:"w-16 bg-transparent text-center text-3xl font-black text-white border-0 focus:ring-0 p-0",value:k}),(0,t.jsx)("button",{onClick:()=>C(e=>e+1),className:"px-5 py-4 hover:bg-gray-800 text-gray-400 hover:text-white transition-colors active:bg-gray-700",children:"+"})]})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-7",children:v?(0,t.jsxs)("div",{className:"bg-gray-900/80 backdrop-blur-xl border border-gray-800/80 rounded-3xl p-6 shadow-xl h-full flex flex-col relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-primary via-emerald-400 to-transparent"}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6 border-b border-gray-800/60 pb-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white flex items-center gap-3",children:"⚽ Goleadores del Partido"}),(0,t.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:["Asigna qui\xe9n marc\xf3 nuestros ",(0,t.jsx)("strong",{className:"text-primary text-base",children:N})," goles."]})]}),(0,t.jsx)("div",{className:"px-4 py-1.5 rounded-xl text-sm font-extrabold transition-colors shadow-sm ".concat(0===E?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-amber-500/20 text-amber-400 border border-amber-500/30"),children:0===E?"✅ \xa1Completado!":"⚠️ Faltan ".concat(E)})]}),0===N?(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8 bg-gray-950/50 rounded-2xl border border-dashed border-gray-800/60",children:[(0,t.jsx)("span",{className:"text-5xl mb-4 opacity-70",children:"\uD83D\uDC94"}),(0,t.jsx)("p",{className:"text-gray-400 font-medium",children:"No ganamos esta vez. No hay goles que registrar a favor."})]}):(0,t.jsx)("div",{className:"flex-1 overflow-y-auto pr-3 space-y-3 pb-4 max-h-[450px] custom-scrollbar",children:u.map(e=>{let a=_[e.id]||0;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-2xl transition-all duration-300 ".concat(a>0?"bg-primary/15 border border-primary/40 shadow-[0_0_15px_rgba(20,184,106,0.1)] scale-[1.01]":"bg-gray-950/50 hover:bg-gray-800/80 border border-gray-800/60 hover:border-gray-700"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:"flex items-center justify-center w-10 h-10 rounded-full text-sm font-black shadow-inner ".concat(a>0?"bg-primary text-gray-950":"bg-gray-800 text-gray-300"),children:e.dorsal}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-bold ".concat(a>0?"text-white":"text-gray-200"),children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider mt-0.5",children:e.posicion})]})]}),(0,t.jsxs)("div",{className:"flex items-center bg-gray-950 border border-gray-700/80 rounded-xl overflow-hidden shadow-inner shrink-0",children:[(0,t.jsx)("button",{onClick:()=>P(e.id,-1),disabled:0===a,className:"px-4 py-3 hover:bg-gray-800 disabled:opacity-30 disabled:hover:bg-transparent text-gray-400 transition-colors focus:outline-none",children:"-"}),(0,t.jsx)("span",{className:"w-10 text-center font-black text-lg ".concat(a>0?"text-primary":"text-gray-500"),children:a>0?a:"0"}),(0,t.jsx)("button",{onClick:()=>P(e.id,1),disabled:0===E,className:"px-4 py-3 hover:bg-gray-800 disabled:opacity-30 disabled:hover:bg-transparent text-gray-400 transition-colors focus:outline-none",children:"+"})]})]},e.id)})}),(0,t.jsx)("div",{className:"mt-auto pt-6 border-t border-gray-800/60",children:(0,t.jsx)("button",{onClick:H,disabled:z||0!==E,className:"w-full flex items-center justify-center gap-3 bg-primary hover:bg-primary/90 text-primary-foreground font-bold py-4 px-6 rounded-2xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-[0_0_20px_rgba(20,184,106,0.2)] hover:shadow-[0_0_30px_rgba(20,184,106,0.4)] active:scale-[0.98] text-lg",children:z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n,{className:"h-6 w-6 animate-spin"})," Guardando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{className:"h-6 w-6"})," Guardar Resultado del Partido"]})})})]}):(0,t.jsxs)("div",{className:"bg-gradient-to-br from-gray-900 to-gray-900/50 border border-gray-800/60 rounded-3xl p-6 h-full flex flex-col items-center justify-center text-center shadow-lg relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-[0.03]"}),(0,t.jsxs)("div",{className:"w-24 h-24 bg-gray-800/50 rounded-full flex items-center justify-center mb-6 shadow-inner relative z-10",children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-full border border-gray-700 animate-[spin_10s_linear_infinite]"}),(0,t.jsx)("span",{className:"text-4xl animate-bounce",children:"⚽"})]}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-200 mb-3 relative z-10",children:"Ning\xfan partido seleccionado"}),(0,t.jsx)("p",{className:"text-gray-500 max-w-sm text-lg relative z-10",children:"Selecciona un partido de la lista en la izquierda para comenzar a gestionar el resultado y los goleadores de la jornada."})]})})]})]})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,t.jsx)(n,{className:"animate-spin text-primary h-8 w-8"})})}},55477:(e,a,r)=>{Promise.resolve().then(r.bind(r,42819))},71847:(e,a,r)=>{"use strict";r.d(a,{A:()=>n});var t=r(12115);let s=function(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return a.filter((e,a,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===a).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)((e,a)=>{let{color:r="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:x,...m}=e;return(0,t.createElement)("svg",{ref:a,...l,width:i,height:i,stroke:r,strokeWidth:o?24*Number(n)/Number(i):n,className:s("lucide",d),...m},[...x.map(e=>{let[a,r]=e;return(0,t.createElement)(a,r)}),...Array.isArray(c)?c:[c]])}),n=(e,a)=>{let r=(0,t.forwardRef)((r,l)=>{let{className:n,...o}=r;return(0,t.createElement)(i,{ref:l,iconNode:a,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...o})});return r.displayName="".concat(e),r}}},e=>{e.O(0,[190,441,255,358],()=>e(e.s=55477)),_N_E=e.O()}]);