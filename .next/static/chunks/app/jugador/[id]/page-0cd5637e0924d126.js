(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[819],{3941:(e,a,r)=>{"use strict";r.d(a,{N:()=>t});let t=(0,r(92373).UU)("https://aknyrfoxlpphebkfomwx.supabase.co","sb_publishable_Z36O_vV2RpFxkajpCPpU7w_D9ve-o3k")},19178:(e,a,r)=>{Promise.resolve().then(r.bind(r,22391)),Promise.resolve().then(r.t.bind(r,52619,23))},22391:(e,a,r)=>{"use strict";r.d(a,{EditableAvatar:()=>u});var t=r(95155),s=r(12115),o=r(15239),l=r(35299);let c=(0,r(71847).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var i=r(3941),n=r(18720),d=r(20063);function u(e){let{jugadorId:a,currentFotoUrl:r,jugadorNombre:u}=e,f="https://ui-avatars.com/api/?name=".concat(encodeURIComponent(u),"&background=0D8ABC&color=fff&size=200"),[p,h]=(0,s.useState)(r||f),[m,g]=(0,s.useState)(!1),[b,v]=(0,s.useState)(!1),x=(0,s.useRef)(null),y=(0,d.useRouter)();(0,s.useEffect)(()=>{h(r||f)},[r,f]),(0,s.useEffect)(()=>{(async()=>{let{data:{session:e}}=await i.N.auth.getSession();e&&v(!0)})()},[]);let w=async e=>{try{if(g(!0),!e.target.files||0===e.target.files.length)throw Error("Debes seleccionar una imagen para subir.");let r=e.target.files[0],t=r.name.split(".").pop(),s="avatars/".concat(a,"-").concat(Math.random(),".").concat(t),{error:o,data:l}=await i.N.storage.from("galeria").upload(s,r,{upsert:!0});if(o)throw o;let{data:c}=i.N.storage.from("galeria").getPublicUrl(s),d=c.publicUrl,u=await fetch("/api/players/avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jugador_id:a,foto_url:d})});if(!u.ok){let e=await u.json();throw Error(e.error||"Error actualizando el perfil del jugador")}h(d),n.o.success("Foto de perfil actualizada correctamente"),y.refresh()}catch(e){console.error("Error uploading avatar:",e),n.o.error(e.message||"No se pudo subir la foto de perfil.")}finally{g(!1),x.current&&(x.current.value="")}};return(0,t.jsxs)("div",{className:"relative h-48 w-48 sm:h-64 sm:w-64 rounded-2xl overflow-hidden border-4 border-card shadow-xl ring-4 ring-accent/20 bg-muted group",children:[(0,t.jsx)(o.default,{src:p,alt:u,fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-105"}),b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,t.jsxs)("button",{onClick:()=>{var e;return null==(e=x.current)?void 0:e.click()},disabled:m,className:"bg-accent/90 hover:bg-accent text-accent-foreground rounded-full p-4 shadow-lg transform transition-transform hover:scale-110 flex flex-col items-center justify-center",children:[m?(0,t.jsx)(l.A,{className:"h-8 w-8 animate-spin"}):(0,t.jsx)(c,{className:"h-8 w-8"}),(0,t.jsx)("span",{className:"text-xs font-bold mt-1",children:m?"Subiendo...":"Cambiar Foto"})]})}),(0,t.jsx)("input",{type:"file",ref:x,accept:"image/*",className:"hidden",onChange:w,disabled:m})]})]})}},35299:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(71847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}},e=>{e.O(0,[190,619,720,473,441,255,358],()=>e(e.s=19178)),_N_E=e.O()}]);